<!doctype html><html lang=en><head><meta name=google-site-verification content="NTPifZ1gNpp6HSoC60ErvHiUUor86ZXg4yHtlpk9lwU"><title>Andrea Dainese > Vulnerability Management</title><meta charset=utf-8><meta name=author content="Andrea Dainese"><meta name=description content="A lot has already been said about Vulnerability Management (VM), and I&rsquo;ve personally touched on this topic several times before. Yet, the reality is that managing vulnerabilities remains a significant challenge for most organizations."><meta name=generator content="Hugo 0.115.3"><meta name=“robots” content="“noarchive”"><meta name=“robots” content="“notranslate”"><meta name=robots content="noimageindex"><meta property="og:title" content="Vulnerability Management"><meta property="og:description" content="A lot has already been said about Vulnerability Management (VM), and I&rsquo;ve personally touched on this topic several times before. Yet, the reality is that managing vulnerabilities remains a significant challenge for most organizations."><meta property="og:type" content="article"><meta property="og:url" content="https://www.adainese.it/blog/2024/12/02/vulnerability-management/"><meta property="og:image" content="https://www.adainese.it/cover.png"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-12-02T00:00:00+00:00"><meta property="article:modified_time" content="2024-12-02T00:00:00+00:00"><meta property="og:site_name" content="Andrea Dainese"><meta name=twitter:card content="summary"><meta name=twitter:site content="@adainese"><meta name=twitter:image content="https://www.adainese.itcover.png"><meta name=twitter:title content="Andrea Dainese > Vulnerability Management"><meta name=twitter:description content="A lot has already been said about Vulnerability Management (VM), and I&rsquo;ve personally touched on this topic several times before. Yet, the reality is that managing vulnerabilities remains a significant challenge for most organizations."><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/rss+xml title="RSS Feed for blog" href=/blog/index.xml><link rel=dns-prefetch href=https://www.googletagmanager.com><link href=https://www.googletagmanager.com rel=preconnect crossorigin><link rel=apple-touch-icon sizes=57x57 href=/favicon/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/favicon/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/favicon/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/favicon/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/favicon/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/favicon/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/favicon/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/favicon/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/favicon/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/favicon/android-icon-192x192.png><link rel=icon type=image/png sizes=16x16 href=/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon/favicon-96x96.png><link rel=stylesheet type=text/css href=/plugins/fontawesome/css/all.min.css><link rel=stylesheet type=text/css href=/plugins/fancybox/jquery.fancybox.min.css><link rel=stylesheet type=text/css href=/fonts/opensans/opensans.css><link rel=stylesheet href=/css/style.min.db8a68dfac8ad6ed301e5f04872a83daee269833ef371fd9ec9475b745de14e5.css integrity="sha256-24po36yK1u0wHl8EhyqD2u4mmDPvNx/Z7JR1t0XeFOU="><link rel=stylesheet href=/css/print.min.a3802e6b39df8780c4980151b47550b34687a140e148c71342fb463b5322e6b1.css media=print integrity="sha256-o4Auaznfh4DEmAFRtHVQs0aHoUDhSMcTQvtGO1Mi5rE="></head><body><button type=button class="mobile-nav-toggle d-lg-none" aria-label="Toggle navigation"><i class="fas fa-bars"></i></button><header id=header class=fixed-top><div class="container d-flex"><div class="logo mr-auto"><h1><a href=/#><span>Andrea</span> Dainese</a></h1></div><nav class="nav-menu d-none d-lg-block"><ul><li><a href=/#>Home</a></li><li><a href=/#about>About</a></li><li class=active><a href=/blog>Blog</a></li><li><a href=/categories>Categories</a></li><li><a href=https://www.patreon.com/adainese target=_blank rel=noreferrer><i class="fa fa-heart"></i></a></li><li><a href=https://www.spreaker.com/podcast/info-sec-unplugged--6025156 target=_blank rel=noreferrer><i class="fa fa-podcast"></i></a></li><li><form class="form-inline ml-2" action=/search><div class="input-group mb-3"><input id=search-query type=text class=form-control placeholder=Search... name=s aria-label="Search within the website" aria-describedby=basic-addon2><div class=input-group-append><button class="btn btn-outline-primary" type=submit aria-label=Search>
<i class="fa fa-search"></i></button></div></div></form></li></ul></nav></div></header><div id=page-header><div class=home-overlay></div><div class=container><div class=row><div class=col-12><div class="page-header-size text-center"><h1>Vulnerability Management</h1></div></div></div></div></div><main id=main><div class=blogpost-single><div class=container><div class=row><div class="col-xs-12 col-sm-12 col-md-4 d-print-none"><div class=blogpost-nav><div class="d-none d-md-block"><div class=blogpost-nav-content><h4>Table of contents</h4><div class=toce><nav id=TableOfContents><ul><li><a href=#what-is-a-vulnerability>What is a vulnerability?</a><ul><li><a href=#process-vulnerabilities>Process vulnerabilities</a></li><li><a href=#psychological-vulnerabilities>Psychological vulnerabilities</a></li><li><a href=#configuration-vulnerabilities>Configuration vulnerabilities</a></li></ul></li><li><a href=#managing-vulnerabilities>Managing vulnerabilities</a><ul><li><a href=#evaluating-a-vulnerability>Evaluating a vulnerability</a></li></ul></li><li><a href=#cvss-score--risk>CVSS Score ≠ Risk</a></li><li><a href=#practically-assessing-a-vulnerability>Practically assessing a vulnerability</a></li><li><a href=#predicting-the-future>Predicting the future</a></li><li><a href=#mitigating-a-vulnerability>Mitigating a vulnerability</a></li><li><a href=#patching>Patching</a></li><li><a href=#mitigating-risk>Mitigating Risk</a></li><li><a href=#va-scanner>VA Scanner</a><ul><li><a href=#generic-risk>Generic Risk</a></li><li><a href=#limited-coverage>Limited Coverage</a></li><li><a href=#local-vulnerabilities>Local Vulnerabilities</a></li><li><a href=#annual-scanning>Annual Scanning</a></li><li><a href=#detection-vs-verification>Detection vs. Verification</a></li></ul></li><li><a href=#vulnerability-management>Vulnerability Management</a></li><li><a href=#automation>Automation</a><ul><li><a href=#immutable-os-and-containers>Immutable OS and Containers</a></li><li><a href=#sbom-and-vulnerabilities-in-templates>SBOM and Vulnerabilities in Templates</a></li></ul></li><li><a href=#post-patching-threat-hunting>Post patching (Threat Hunting)</a></li></ul></nav></div></div></div><div class="d-none d-md-block"><div class=blogpost-nav-content><h4>Latest posts</h4><div class=recent-post><div class=recent-post-img><a href=/blog/2025/11/30/a-practical-cisco-ndo-multi-site-use-case-config-deploy/><img class="img-fluid rounded" src=/images/vendors/cisco.webp alt="Post cover"></a></div><div class=recent-post-content><p><a href=/blog/2025/11/30/a-practical-cisco-ndo-multi-site-use-case-config-deploy/>A practical Cisco NDO multi-site use case: config deploy</a><br><i class="fa fa-calendar"></i>
November 30, 2025</p></div></div><div class=recent-post><div class=recent-post-img><a href=/blog/2025/11/23/a-practical-cisco-ndo-multi-site-use-case-building-the-parser/><img class="img-fluid rounded" src=/images/vendors/cisco.webp alt="Post cover"></a></div><div class=recent-post-content><p><a href=/blog/2025/11/23/a-practical-cisco-ndo-multi-site-use-case-building-the-parser/>A practical Cisco NDO multi-site use case: building the parser</a><br><i class="fa fa-calendar"></i>
November 23, 2025</p></div></div><div class=recent-post><div class=recent-post-img><a href=/blog/2025/11/22/eve-ng-sw-architecture-and-docker-support/><img class="img-fluid rounded" src=/images/vendors/eve-ng.webp alt="Post cover"></a></div><div class=recent-post-content><p><a href=/blog/2025/11/22/eve-ng-sw-architecture-and-docker-support/>EVE-NG (SW architecture and docker support)</a><br><i class="fa fa-calendar"></i>
November 22, 2025</p></div></div><div class=recent-post><div class=recent-post-img><a href=/blog/2025/11/16/a-practical-cisco-ndo-multi-site-use-case-data-validation/><img class="img-fluid rounded" src=/images/vendors/cisco.webp alt="Post cover"></a></div><div class=recent-post-content><p><a href=/blog/2025/11/16/a-practical-cisco-ndo-multi-site-use-case-data-validation/>A practical Cisco NDO multi-site use case: data validation</a><br><i class="fa fa-calendar"></i>
November 16, 2025</p></div></div><div class=recent-post><div class=recent-post-img><a href=/blog/2025/11/09/a-practical-cisco-ndo-multi-site-use-case-additional-configuration/><img class="img-fluid rounded" src=/images/vendors/cisco.webp alt="Post cover"></a></div><div class=recent-post-content><p><a href=/blog/2025/11/09/a-practical-cisco-ndo-multi-site-use-case-additional-configuration/>A practical Cisco NDO multi-site use case: additional configuration</a><br><i class="fa fa-calendar"></i>
November 09, 2025</p></div></div></div></div><div class="d-none d-md-block"><div class=blogpost-nav-content><h4>Categories</h4><div class=recent-post><div class=recent-post-img><a href=/categories/automation><img class="img-fluid rounded" src=/images/categories/automation.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/automation>Automation</a><br><i class="fa fa-blog"></i> 170 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/learning-paths><img class="img-fluid rounded" src=/images/categories/learning-paths.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/learning-paths>Learning paths</a><br><i class="fa fa-blog"></i> 134 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/ciso><img class="img-fluid rounded" src=/images/categories/ciso.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/ciso>CISO</a><br><i class="fa fa-blog"></i> 23 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/personal-security><img class="img-fluid rounded" src=/images/categories/personal-security.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/personal-security>Personal Security</a><br><i class="fa fa-blog"></i> 22 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/security><img class="img-fluid rounded" src=/images/categories/security.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/security>Security</a><br><i class="fa fa-blog"></i> 20 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/notes><img class="img-fluid rounded" src=/images/categories/notes.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/notes>Notes</a><br><i class="fa fa-blog"></i> 19 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/infrastructure><img class="img-fluid rounded" src=/images/categories/infrastructure.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/infrastructure>Infrastructure</a><br><i class="fa fa-blog"></i> 12 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/ot-ics><img class="img-fluid rounded" src=/images/categories/ot-ics.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/ot-ics>OT/ICS</a><br><i class="fa fa-blog"></i> 5 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/books><img class="img-fluid rounded" src=/images/categories/books.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/books>Books</a><br><i class="fa fa-blog"></i> 3 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/unetlab><img class="img-fluid rounded" src=/images/categories/unetlab.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/unetlab>UNetLab</a><br><i class="fa fa-blog"></i> 3 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/writeup><img class="img-fluid rounded" src=/images/categories/writeup.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/writeup>Write-up</a><br><i class="fa fa-blog"></i> 3 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/osint><img class="img-fluid rounded" src=/images/categories/osint.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/osint>OSInt</a><br><i class="fa fa-blog"></i> 2 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/life><img class="img-fluid rounded" src=/images/categories/life.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/life>My life</a><br><i class="fa fa-blog"></i> 1 posts</p></div></div></div></div></div></div><div class="col-xs-12 col-sm-12 col-md-8 blogpost-container"><div class=row><div class="col-md-12 col-sm-12 col-xs-12"><article><div class=blogpost-single-content><h2>Vulnerability Management</h2><div class=blogpost-single-meta><div><i class="fa fa-user"></i> Andrea Dainese</div><div><i class="fa fa-calendar"></i>
December 02, 2024</div><div class=tag-meta><i class="fa fa-folder"></i>
<a href=/categories/ciso/ title="All posts under CISO">CISO</a></div></div><div class=entry-content><div><a data-fancybox=gallery href=/blog/2024/12/02/vulnerability-management/cover.webp><img class="img-fluid w-25 rounded shadow float-right" src=/blog/2024/12/02/vulnerability-management/cover.webp alt="Post cover"></a></div><p>A lot has already been said about Vulnerability Management (VM), and I&rsquo;ve personally touched on this topic several times before. Yet, the reality is that managing vulnerabilities remains a significant challenge for most organizations.</p><p>Our offensive activities consistently reveal that, when successful, the attack path often hinges on software or logical vulnerabilities. More often than not, these vulnerabilities were already known to the IT department but, for one reason or another, mitigation wasn&rsquo;t feasible.</p><p>In other words, the success of the offensive action stems from widely known vulnerabilities.</p><p>And this isn&rsquo;t a rare scenario.</p><h2 id=what-is-a-vulnerability>What is a vulnerability?</h2><p>In the most common (and technical) sense, a vulnerability is a software flaw that can compromise confidentiality, integrity, and/or availability. However, this definition only covers a specific category. If we broaden the concept, the term &ldquo;vulnerability&rdquo; can also apply to:</p><ul><li><strong>Processes</strong></li><li><strong>People</strong></li><li><strong>Configurations</strong></li></ul><h3 id=process-vulnerabilities>Process vulnerabilities</h3><p>A process vulnerability arises when workflows fail to ensure confidentiality, potentially exposing sensitive information to unauthorized individuals. For example, I once came across a box of employee pay slips left unattended in a real-world scenario. In that case, the employee handling the box was following the correct procedure, but the procedure itself failed to account for such risks.</p><h3 id=psychological-vulnerabilities>Psychological vulnerabilities</h3><p>These occur when attackers exploit human weaknesses through social engineering techniques. Phishing, tailgating, and piggybacking are classic examples that target psychological vulnerabilities to extract sensitive information.</p><h3 id=configuration-vulnerabilities>Configuration vulnerabilities</h3><p>Also known as logical vulnerabilities, these arise when, for instance, a network share allows unauthorized access. Often, such issues result from oversight, but in some cases, they happen because the individual responsible for the setup lacked the necessary security knowledge.</p><p>Physical vulnerabilities (e.g., locks, doors, gates) could also be mentioned, but focusing too much on these technical aspects might detract from the broader applicability of this discussion.</p><h2 id=managing-vulnerabilities>Managing vulnerabilities</h2><p>Many people immediately associate &ldquo;vulnerability management&rdquo; with patching. But managing a vulnerability doesn&rsquo;t mean simply eliminating it via a software patch. Managing a vulnerability means assessing the associated risk and mitigating it. Mitigation strategies can include:</p><ul><li>Patching or reconfiguring the system</li><li>Shutting down the vulnerable system</li><li>Training employees</li><li>Adding additional security controls</li><li>&mldr;</li></ul><p>In extreme cases, risk can be transferred through insurance (though insurers typically exclude companies deemed too high-risk after their evaluations).</p><h3 id=evaluating-a-vulnerability>Evaluating a vulnerability</h3><p>Not all vulnerabilities are created equal. Each vulnerability has unique characteristics regarding type, impact, exploitability, and mitigatability. This means we can&rsquo;t rely solely on standard reports; we need to complement them with public information—subject to change over time—and data specific to our organization.</p><p>In other words, we need a <strong>risk-based mindset</strong> when addressing vulnerabilities.</p><p>One critical aspect to emphasize: the risk associated with a vulnerability <strong>changes over time</strong>. Typically (though not always), a vulnerability is discovered, eventually exploited, and then becomes dangerous. Furthermore, 2024 alone has shown us several examples of patches that failed to fully resolve issues. This highlights the necessity of continuously monitoring each vulnerability.</p><p>To better assess vulnerabilities, we should evaluate the likelihood of them being maliciously exploited. This evaluation can consider:</p><ul><li>Whether the vulnerability is practically exploitable.</li><li>Whether public exploits exist.</li><li>Evidence, on a global scale, of exploitation by threat actors.</li><li>Which assets are affected, particularly regarding the data they contain.</li><li>The potential for <strong>lateral movement</strong>, i.e., spreading from a compromised asset to adjacent assets.</li><li>Existing security measures designed to block threats targeting the vulnerable assets.</li></ul><p>A simplified approach might distill this into three primary factors:</p><ul><li><strong>Likelihood of exploitation</strong>, based on the global threat landscape.</li><li><strong>Impact on the organization</strong> if the vulnerability is exploited.</li><li><strong>Mitigation effectiveness</strong> due to existing security controls.</li></ul><h2 id=cvss-score--risk>CVSS Score ≠ Risk</h2><p>Before discussing how we can assess a vulnerability, we need to clarify a common misconception: the CVSS value cannot be the foundation of our vulnerability assessment process.</p><p>The first reason is that a vulnerability may not have an associated CVE. There are various reasons why this might happen:</p><ul><li>The individual who discovered the vulnerability may not have the time or inclination to obtain a CVE designation;</li><li>The vulnerability might not pertain to software, making it impossible to associate a CVE.</li></ul><p>The second reason, as noted on the <a href=https://www.first.org/cvss/specification-document title="CVSS Specification Document">FIRST website</a>, is that the CVSS value is calculated under the assumption that all prerequisites for exploiting the vulnerability are met:</p><blockquote><p>if a specific configuration is required for an attack to succeed, the vulnerable system should be assessed assuming it is in that configuration.</p></blockquote><p>CVSS measures the severity of a vulnerability, not the risk associated with it. With appropriate caution, it can be used to calculate risk, but the gap must be filled for vulnerabilities without an associated CVE.</p><h2 id=practically-assessing-a-vulnerability>Practically assessing a vulnerability</h2><p>My approach emphasizes practical and sustainable actions for companies to achieve swift and effective improvements in corporate security. Even at the cost of oversimplifying the theory, my focus is always on the objective.</p><p>We&rsquo;ve seen that CVSS cannot be used as a sole metric, both because it requires contextualization and because not all vulnerabilities have an associated CVE.</p><p>Many tools for detecting vulnerabilities simplify the process by assuming a risk factor. While this makes the tool easier to use, the resulting data must be supplemented with contextual information.</p><p>In practice, the simplest (but, as we&rsquo;ll see, incorrect) approach involves using vulnerability scanning tools that identify latent vulnerabilities, associating a risk factor with each.</p><p>Unfortunately, it is quite common for vulnerability scans in organizations to reveal thousands—or even tens of thousands—of vulnerabilities of varying severity. Equally common is the sense of despair among managers who review such reports, as the task ahead may seem insurmountable.</p><p>The issue lies in the fact that, in any organization, certain activities take precedence over everything else. In other words, vulnerabilities will continue to accumulate because:</p><ul><li>Some systems cannot be shut down;</li><li>Some systems are untouchable;</li><li>Some systems are critical but no longer supported;</li><li>Nobody wants to risk deploying a flawed patch and compromising a critical business service.</li></ul><p>I have previously discussed the <strong>assume breach design</strong> concept, which I&rsquo;ll revisit here: every system should be designed with the understanding that it could eventually be compromised. Specifically, if an organization has untouchable systems, these must be placed in a high-security area. This is always the case in the ICS/OT domain, which I&rsquo;ve addressed in a dedicated post.</p><p>In this context, vulnerability management should begin at the design phase, incorporating security measures to reduce the risk of compromise. However, post-design efforts can be made—albeit labor-intensive—to rethink the architecture.</p><p>My approach, appropriately simplified (and incomplete), for evaluating a vulnerability involves:</p><ul><li>using the risk factor suggested by the vulnerability scanning tool;</li><li>potentially adjusting this factor if the context requires it;</li><li>applying a corrective value that reflects the impact on the organization;</li><li>applying a corrective value that reflects the security measures implemented within the organization.</li></ul><p>In practice:</p><ul><li>the risk factor is rarely customized;</li><li>the risk factor considers the vulnerability net of any existing security measures, meaning it represents a publicly exposed asset;</li><li>the impact on the organization is a pre-calculated factor for each security zone (in this sense, I assume that a compromise can freely propagate within the same zone);</li><li>the corrective value is pre-calculated for the security measures present in the organization (firewalls, IPS, EDR, SIEM, etc.).</li></ul><p>Obviously, the approach is imprecise, incomplete, and partly incorrect (we will see why later). However, the contribution it brings to organizations is significant:</p><ul><li>thousands of vulnerabilities are now weighted based on the security measures in place, making it possible to define priorities;</li><li>security measures are considered, allowing for discussions about whether untouchable assets should be moved to separate zones;</li><li>the impact of a complete attack is considered, not just that of the vulnerable asset;</li><li>it allows for defining justifications for why certain assets might remain unpatched.</li></ul><p>This approach, sometimes referred to as <strong>risk-based vulnerability assessment</strong>, is gaining increasing traction. Specifically, I am observing that the compliance and insurance sectors are welcoming a risk-based approach and evaluating it positively.</p><p>In other words, it is justified for critical vulnerabilities to exist, provided they are managed with a risk-based approach.</p><h2 id=predicting-the-future>Predicting the future</h2><p>In a pragmatic approach, a vulnerability is considered as such if it can be exploited. Many vulnerabilities require such specific conditions that, in practice, exploitation becomes unfeasible. The CVSS value <a href=https://www.first.org/cvss/specification-document title="CVSS Specification Document">takes into account the complexity of the attack</a>, but it does so with only two possibilities: low and high.</p><p>FIRST has defined a parameter that represents the probability that a vulnerability will be exploited in the next 30 days:</p><blockquote><p>EPSS is a measure of exploitability. Specifically, EPSS is estimating the probability of observing any exploitation attempts against a vulnerability in the next 30 days.</p></blockquote><p>The value of <a href=https://www.first.org/epss/ title="Exploit Prediction Scoring System">EPSS</a> (Exploit Prediction Scoring System), <strong>variable over time</strong>, helps us define the SLA to mitigate each vulnerability associated with a CVE.</p><h2 id=mitigating-a-vulnerability>Mitigating a vulnerability</h2><p>At this point, we should have a list of vulnerabilities with associated risk, net of security measures (Inherent Risk), and a mitigation factor that represents the security measures in place (EDR, firewall, awareness, etc.). The combination of these two factors allows us to determine the risk that a vulnerability will be exploited, considering the security measures (Residual Risk).</p><p>Before sorting this list in descending order of risk and starting to compile the remediation plan, we are missing one last factor: risk appetite (Risk Appetite). This factor indicates the level of risk that our organization considers acceptable. Once defined, all vulnerabilities with a Residual Risk below this factor are automatically ignored. If we have any doubts, it means our risk model has some flaws.</p><p>We have now obtained a list of real, exploitable vulnerabilities for which the risk is not considered acceptable. We must therefore define actions to reduce the risk of each vulnerability.</p><p>Risk can be:</p><ul><li><strong>resolved</strong>, for example by updating the vulnerable software or shutting it down;</li><li><strong>mitigated</strong>, by implementing a new security measure (e.g., moving the vulnerable system to a higher security zone);</li><li><strong>transferred</strong>, for example through insurance or third parties.</li></ul><h2 id=patching>Patching</h2><p>Often, a vulnerability can be resolved by installing an update. However, we must ask ourselves when this action should be taken. I have seen organizations with monthly patching policies, at best. In the worst cases, systems are updated once a year or even less frequently.</p><p>First, each system and application should have a well-defined maintenance window.</p><p>Second, we must associate a specific SLA with risk categories: the higher the risk, the faster the updates must be installed, and consequently, the maintenance windows must be scheduled at shorter intervals. Paradoxically, the more critical a system is from a business perspective, the more frequently it must be taken offline for maintenance.</p><p>For this reason, organizations tend to perform what I call &ldquo;blind patching,&rdquo; which focuses not on risk but on systems that are easiest to update. This is the exact reason that causes the accumulation of hundreds or thousands of vulnerabilities in many companies.</p><p>An additional consideration on patching activities is often their lack of proper &ldquo;dignity.&rdquo; People responsible for patching do so at their own risk:</p><ul><li>if everything goes well, they receive no recognition;</li><li>if something goes wrong, they are blamed for the disruption and are responsible for restoring the service.</li></ul><p>In this environment, people will avoid taking on patching tasks, causing further delays. If we think that the lack of patching is a resource problem, we will soon discover that the real issue is that no one wants to press the button and take on the associated responsibility.</p><p>From an organizational perspective, it is unrealistic to have a cross-functional team responsible for software updates. Each system serves an application necessary for the business. In this sense, applications and systems have an assigned owner who guarantees the service. If we want the process to work, we cannot decouple the application responsibility from the update responsibility.</p><p>The final consideration concerns the maximum time to mitigate a vulnerability. This time depends on conditions that change over time (as we have already discussed with EPSS). It is worth citing a <a href=https://blog.cloudflare.com/application-security-report-2024-update/ title="Application Security report: 2024 update">Cloudflare report</a>:</p><blockquote><p>CVEs exploited as fast as 22 minutes after proof-of-concept published</p></blockquote><p><a data-fancybox=gallery href=/blog/2024/12/02/vulnerability-management/vuln-timeline.webp><img sizes="800 1110 " srcset="/blog/2024/12/02/vulnerability-management/vuln-timeline_hue3cd444ee88b89f697baacce3728808e_33764_800x0_resize_q75_h2_box_2.webp /blog/2024/12/02/vulnerability-management/vuln-timeline.webp" src=/blog/2024/12/02/vulnerability-management/vuln-timeline.webp alt="JetBrains TeamCity authentication bypass timeline" class="img-fluid rounded shadow mx-auto d-block text-center"></a></p><p>22 minutes is an impossible time frame to manage these vulnerabilities manually. In 22 minutes, we might not even notice the new vulnerability. We need to think about a different approach.</p><h2 id=mitigating-risk>Mitigating Risk</h2><p>We have already stated that patching is one of the possibilities for managing software vulnerabilities. However, there are many cases where patching cannot be performed. The typical reasons are:</p><ul><li>The application cannot be stopped frequently enough to allow continuous patching;</li><li>The application is no longer supported, and updates are no longer available;</li><li>The application is no longer sold and/or the vendor no longer exists.</li></ul><p>There are also more operational reasons, such as:</p><ul><li>No one wants to take responsibility for updating a mission-critical application;</li><li>There is no proper rollback system;</li><li>The risk of encountering issues is higher than the risk of leaving the application as is.</li></ul><p>This situation is common in ICS/OT environments, especially in production, medical, naval, utilities, oil & gas sectors&mldr; But, on closer inspection, every company has applications that cannot be updated.</p><p>We must also consider that, very often, business processes are tied to a specific application. The evolution of this application is often faster than the speed at which business processes can evolve. A prime example: the company relies on a specific CRM with customizations that are key to business processes. Subsequent major releases of that CRM do not guarantee full portability of customizations, forcing the company to spend time and resources chasing each successive release.</p><p>It thus becomes clear that if we use patching as the only method to resolve software vulnerabilities, we will always have a set of unmanageable objects.</p><p>If we return to a risk-based approach, things change.</p><p>If we know the risk associated with each application (and thus each asset), we can isolate it in a specific security zone protected by adequate security measures. For example, if we have industrial systems that are particularly vulnerable and important at the same time, we can isolate them in a secure zone. Communications to and from this zone can be limited and controlled to reduce the risk of compromise.</p><p>We have just described the Purdue model (SANS Secure Architecture for Industrial Control Systems), which suggests creating a containment zone between the IT and OT worlds.</p><p><a data-fancybox=gallery href=/blog/2024/12/02/vulnerability-management/purdue-model.webp><img sizes="800 922 " srcset="/blog/2024/12/02/vulnerability-management/purdue-model_hua171df173e8e6d2c5f2e3a24d868b363_99918_800x0_resize_q75_h2_box_2.webp /blog/2024/12/02/vulnerability-management/purdue-model.webp" src=/blog/2024/12/02/vulnerability-management/purdue-model.webp alt="Purdue Model" class="img-fluid rounded shadow mx-auto d-block text-center"></a></p><p>It is not certain that the Purdue Model can be implemented in your company, and it likely cannot, but we can use that idea to separate critical, non-upgradable applications from those that are manageable. By optimizing security measures, we can create a sufficiently strong barrier to protect even the most fragile devices.</p><p>Security measures can include:</p><ul><li>Firewalls with particularly stringent rules;</li><li>Web Application Firewall (WAF);</li><li>EDR / XDR;</li><li>Behavioral analysis;</li><li>Active monitoring services;</li><li>NAC (Network Access Control);</li><li>Microsegmentation;</li><li>Network probes;</li><li>Honeypots;</li><li>&mldr;</li></ul><p>In practice, my advice is to start with a well-structured asset inventory. Each asset should be characterized based on its impact on business operations (see NIS2) and personal data (GDPR). Each asset should also have a defined maintenance window: this value is key to understanding how much we can operate on an asset without impacting the business.</p><p>Where the maintenance window is insufficient to ensure proper maintenance, we need to mitigate the potential risk of compromise by enhancing security measures.</p><p>We can then define the necessary security zones protected by additional security measures. Ideally, these security measures can be represented by a numerical factor, which can be used to calculate residual risk. This way, for each security zone, there will be a mitigation factor associated with the assets contained within that zone.</p><p>This approach allows us to extend traditional vulnerability scanning tools by including the context, i.e., the protection derived from the security zone in which the assets reside.</p><h2 id=va-scanner>VA Scanner</h2><p>The most common system today for identifying software vulnerabilities within an organization is Vulnerability Assessment (VA). Specifically, we are talking about Vulnerability Scanner applications that scan the network for known vulnerabilities. Vulnerabilities are detected through signatures: if a service announces its version and it is vulnerable, the scanner will report that service as vulnerable.</p><p>It is clear that these tools are often overrated.</p><h3 id=generic-risk>Generic Risk</h3><p>Vulnerability scanners provide a report of detected vulnerabilities, associating a risk with each vulnerability. However, this risk factor is obviously incomplete: it lacks context.</p><p>However, we have already seen how to assess risk by associating specific information about the asset and the available security measures.</p><h3 id=limited-coverage>Limited Coverage</h3><p>The effectiveness of a scanner, or its ability to find all vulnerabilities present in the infrastructure, is tied to the signature database that the scanner uses. No scanner can have 100% coverage for two reasons:</p><ul><li>The software landscape is highly diverse, and there are products (like WordPress) that can be extended by a vast ecosystem of plugins;</li><li>Almost every organization has custom applications.</li></ul><p>While the utility of a Vulnerability Scanner is undeniable because it allows for the analysis of thousands of devices in a very short time, it is also true that there must be plans for deeper analysis of well-known applications that may not be covered by the scanner.</p><p>It is also worth mentioning that many companies turn to different vendors to perform VA, hoping to gain better coverage over time. It is obvious that if all companies use the same scanner, the result will be the same. At most, the interpretation may vary.</p><h3 id=local-vulnerabilities>Local Vulnerabilities</h3><p>In almost all cases, Vulnerability Assessments are limited to network scanning. This means that all local vulnerabilities—such as those that could be exploited to escalate privileges after gaining local access—are completely overlooked.</p><h3 id=annual-scanning>Annual Scanning</h3><p>If Vulnerability Assessments are conducted to detect vulnerabilities, we must consider the maximum time that may pass from when a vulnerability becomes public (and starts being exploited) to when we become aware of it.</p><p>We have seen that active exploitation of a vulnerability can occur within minutes of its discovery. Therefore, conducting annual, semi-annual, quarterly, or even monthly scans makes little sense.</p><h3 id=detection-vs-verification>Detection vs. Verification</h3><p>Vulnerability scanning systems are not meant to discover vulnerabilities; rather, they are intended to check the vulnerability management process.</p><p>In other words, if the vulnerability management process is functioning correctly, the scanner&rsquo;s report will almost always (if not always) be redundant.</p><p><a data-fancybox=gallery href=/blog/2024/12/02/vulnerability-management/va-report.webp><img sizes="800 977 " srcset="/blog/2024/12/02/vulnerability-management/va-report_hu4b2aa1bf19cbc45f8bf9ae5be3faefe1_36874_800x0_resize_q75_h2_box_2.webp /blog/2024/12/02/vulnerability-management/va-report.webp" src=/blog/2024/12/02/vulnerability-management/va-report.webp alt="Vulnerability Assessment report" class="img-fluid rounded shadow mx-auto d-block text-center"></a></p><h2 id=vulnerability-management>Vulnerability Management</h2><p>The vulnerability management process brings together all the considerations we&rsquo;ve made so far and formalizes the operational procedures. The process begins when a new vulnerability is detected, and this can happen through various sources:</p><ul><li>Reports;</li><li>Automated tools;</li><li>Individuals.</li></ul><p>Each report will be analyzed and evaluated to understand the associated risk. If the inherent risk, reassessed based on the existing security measures, exceeds the activation threshold, the change management process will need to be triggered to further mitigate the vulnerability.</p><p><a data-fancybox=gallery href=/blog/2024/12/02/vulnerability-management/vulnerability-management.webp><img sizes="500 793 " srcset="/blog/2024/12/02/vulnerability-management/vulnerability-management_huea742640651d3738e7bfa7cf3798411c_36648_500x0_resize_q75_h2_box_2.webp /blog/2024/12/02/vulnerability-management/vulnerability-management.webp" src=/blog/2024/12/02/vulnerability-management/vulnerability-management.webp alt="Vulnerability management workflow" class="img-fluid rounded shadow mx-auto d-block text-center"></a></p><p>To summarize:</p><ul><li><strong>Patch Management</strong>: Involves updating software to supported versions. Updates to resolve functional bugs are part of this process.</li><li><strong>Application Lifecycle Management</strong>: Involves the removal or migration of obsolete applications that have reached the end of their lifecycle.</li><li><strong>Vulnerability Management</strong>: Involves reducing the risk associated with known vulnerabilities.</li></ul><h2 id=automation>Automation</h2><p>We have seen that the time interval between the discovery of a technical vulnerability and its exploitation &ldquo;in the wild&rdquo; is very small. On the other hand, technical vulnerabilities are constant, and managing updates to address them requires significant effort. We have also seen that the most critical systems are the hardest to update, both due to the difficulty of halting them and the reluctance to modify critical systems that are functioning.</p><p>We cannot today think of addressing the vulnerability management process without using automatic or semi-automatic systems. The most basic form of automation, usually applied to end-user devices, involves a weekly update. More complex workflows involve, upon confirmation, updating systems first on test groups, then on groups with increasing criticality.</p><p>My experience tells me that the more a process is defined and automated within the organization, the less likely people are to question it. In other words, if a system stops functioning due to someone manually updating the system, the responsibility will fall on that person. But if a system is updated through an automated organizational process, any malfunctions are accepted and managed.</p><h3 id=immutable-os-and-containers>Immutable OS and Containers</h3><p>&ldquo;Immutable&rdquo; systems do not allow for modifications. In other words, an immutable system is created, configured, typically through an automated process, and then destroyed without anyone modifying it. Containers behave the same way in this regard.</p><p>Likewise, immutable systems and containers are not updated but are instead destroyed and recreated from an updated base template.</p><p>This approach, used by organizations with a strong DevOps culture, is ideal for:</p><ul><li>Managing system changes, including updates;</li><li>Creating test groups with increasing criticality;</li><li>Applying updates on a daily/hourly basis;</li><li>Performing rollbacks to the previous version in a matter of seconds.</li></ul><h3 id=sbom-and-vulnerabilities-in-templates>SBOM and Vulnerabilities in Templates</h3><p>Those who develop, and even those who use open-source software, should monitor the vulnerabilities of the libraries that their main application depends on. This may seem, and indeed is, a monumental task. However, it can be tackled by structuring an automated process to perform these checks.</p><p>The goal is to prevent situations like the one seen with <a href=https://nvd.nist.gov/vuln/detail/cve-2021-44228 title="CVE-2021-44228 Detail">Log4Shell</a>.</p><p>One potential approach involves using the <a href=https://github.com/CycloneDX title="CycloneDX SBOM Standard">CycloneDX utility</a> to get a list of the libraries used by a specific software in a standard format (SBOM or Software Bill of Materials). This list can then be used by a second utility to analyze any vulnerabilities:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cyclonedx-npm package.json.bak_00.md &gt; sbom.json
</span></span><span style=display:flex><span>bomber scan sbom.json
</span></span></code></pre></div><p><a data-fancybox=gallery href=/blog/2024/12/02/vulnerability-management/sbom.webp><img sizes="367 " srcset=/blog/2024/12/02/vulnerability-management/sbom.webp src=/blog/2024/12/02/vulnerability-management/sbom.webp alt="SBOM analysis" class="img-fluid rounded shadow mx-auto d-block text-center"></a></p><p>The mechanism is certainly improvable, but it is a first step in structuring a process to monitor, as much as possible, the applications installed within the organization.</p><h2 id=post-patching-threat-hunting>Post patching (Threat Hunting)</h2><p>We reach the end of this long post by considering the vulnerability lifecycle:</p><p><a data-fancybox=gallery href=/blog/2024/12/02/vulnerability-management/vulnerability-lifecycle.webp><img sizes="1200 1771 " srcset="/blog/2024/12/02/vulnerability-management/vulnerability-lifecycle_huee88389bbbd24dcffec3c73d03887ea1_58730_1200x0_resize_q75_h2_box_2.webp /blog/2024/12/02/vulnerability-management/vulnerability-lifecycle.webp" src=/blog/2024/12/02/vulnerability-management/vulnerability-lifecycle.webp alt="Vulnerability lifecycle" class="img-fluid rounded shadow mx-auto d-block text-center"></a></p><p>Once a vulnerability is resolved, we must ask ourselves a key question: is it possible that this vulnerability has already been exploited? How should we proceed?</p><p>The answer is not simple and depends heavily on the vulnerability. In some cases, there are Indicators of Compromise (IoC) associated with the vulnerability that help us determine whether the vulnerability has already been exploited, but in many cases, these indicators are not available.</p><p>Ideally, organizations regularly perform an activity (Threat Hunting) aimed at detecting silent threats already within the organization that, for some reason, were not detected or blocked by other security systems.</p><p>Our vulnerability management process could therefore trigger specific Threat Hunting activities for the vulnerability we are managing. For example, we might want to initiate in-depth analyses for particularly critical vulnerabilities, with an EPSS score above 70%.</p><h2>References</h2><ul><li><a href=https://www.first.org/cvss/specification-document title="CVSS Specification Document" target=_blank rel=noopener>CVSS Specification Document</a></li><li><a href=https://www.first.org/epss/ title="Exploit Prediction Scoring System" target=_blank rel=noopener>Exploit Prediction Scoring System</a></li><li><a href=https://blog.cloudflare.com/application-security-report-2024-update/ title="Application Security report: 2024 update" target=_blank rel=noopener>Application Security report: 2024 update</a></li></ul></div></div></article><div class=clear></div></div></div></div></div></div></div></main><footer class=d-print-none><div class=footer-profile><div class=container id=contact><div class=row><div class="col-xs-12 col-sm-12 col-md-4"><div class=footer-head><h2><span>Andrea</span> Dainese</h2></div><p>For information, collaborations, proposals, requests for help, donations, use one of the following channels; email is preferred.</p><div class=footer-icons><ul><li><a href=https://www.patreon.com/adainese title="Support me" target=_blank rel=noreferrer><i class="fa fa-heart"></i></a></li><li><a href=https://www.linkedin.com/in/adainese/ title="LinkedIn profile" target=_blank rel=noreferrer><i class="fab fa-linkedin-in"></i></a></li><li><a href=https://twitter.com/adainese title="Twitter profile" target=_blank rel=noreferrer><i class="fab fa-twitter"></i></a></li><li><a href=mailto:andrea@adainese.it title="Secure email" target=_blank rel=noreferrer><i class="fa fa-envelope"></i></a></li><li><a href=https://www.spreaker.com/podcast/info-sec-unplugged--6025156 title=Podcast target=_blank rel=noreferrer><i class="fa fa-podcast"></i></a></li><li><a href=https://github.com/dainok/ title="GitHub repositories" target=_blank rel=noreferrer><i class="fab fa-github"></i></a></li><li><a href=/blog/index.xml title="RSS Feed" target=_blank><i class="fa fa-rss"></i></a></li></ul></div></div><div class="col-xs-12 col-sm-12 col-md-4"><div class=footer-head><h4>Past events</h4></div><div class=footer-content><ul><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20240305-cisco-aci-automation.pdf title="View slides" target=_blank rel=noreferrer>SDN: Software Defined Now</a></li><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20231122-cybercrime.pdf title="View slides" target=_blank rel=noreferrer>Cybercrime</a></li><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20220901-bgp-attack-scenarios.pdf title="View slides" target=_blank rel=noreferrer>BGP attack scenarios</a></li><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20220317-approaching-ot-ics-security.pdf title="View slides" target=_blank rel=noreferrer>Approaching OT/ICS Security</a> (with <a href=https://www.festocte.it/eventi/industry_4_0/17-03-2022/webinar_la_cybersecurity_nelle_reti_di_fabbrica_P/>Festo Academy</a>)</li><li><a href="https://www.youtube.com/watch?v=sjQZghTkHkA" title="View recording" target=_blank rel=noreferrer><i class="fa fa-video"></i></a>&nbsp;-&nbsp;<a href=/files/slides/20200922-cyberrange.pdf title="View slides" target=_blank rel=noreferrer>Cyber Range: Analyzing a Cyber Attack</a></li><li><a href="https://www.youtube.com/watch?v=-PWtGaS28dk" title="View recording" target=_blank rel=noreferrer><i class="fa fa-video"></i></a>&nbsp;-&nbsp;<a href=/files/slides/20200623-clubitfvg-securing-ot-ics-plants.pdf title="View slides" target=_blank rel=noreferrer>Securing OT/ICS plants</a></li><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20190226-automation-for-cisco-netops.pdf title="View slides" target=_blank rel=noreferrer>Automation for Cisco NetOps</a></li><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20181107-ciscon-sdn-complexity-and-tco-looking-for-an-easy-way.pdf title="View slides" target=_blank rel=noreferrer>SDN, Complexity and TCO</a></li><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20181003-nts-protection-and-visibility-for-enterprise-networks.pdf title="View slides" target=_blank rel=noreferrer>Protection and visibility for enterprise networks</a></li><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20141106-festival-ict-why-wan-accelerators-still-matter.pdf title="View slides" target=_blank rel=noreferrer>Why WAN AccelerAtors (still) matter?</a></li><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20130918-festival-ict-designing-an-hybrid-data-center-infrastructure.pdf title="View slides" target=_blank rel=noreferrer>Designing an Hybrid Data Center Infrastructure</a></li></ul></div></div><div class="d-none d-md-block col-md-4"><div class=footer-head><h4>Competencies</h4></div><div class=footer-slides><div class=footer-slide-container><div class=footer-slide><img src=/images/categories/security-125x100.webp alt="Incident Response"><div class=overlay>Incident Response</div></div></div><div class=footer-slide-container><div class=footer-slide><img src=/images/categories/ciso-125x100.webp alt=Advisor><div class=overlay>Advisor</div></div></div><div class=footer-slide-container><div class=footer-slide><img src=/images/categories/osint-125x100.webp alt="Open Source Intelligence (OSINT)"><div class=overlay>Open Source Intelligence (OSINT)</div></div></div><div class=footer-slide-container><div class=footer-slide><img src=/images/categories/infrastructure-125x100.webp alt="System Integration / Automation"><div class=overlay>System Integration / Automation</div></div></div><div class=footer-slide-container><div class=footer-slide><img src=/images/categories/writeup-125x100.webp alt="Training / Education / Cyber Range"><div class=overlay>Training / Education / Cyber Range</div></div></div><div class=footer-slide-container><div class=footer-slide><img src=/images/categories/personal-security-125x100.webp alt="Personal Security"><div class=overlay>Personal Security</div></div></div></div></div></div></div></div><div class=footer-copyright><div class=container><div class=row><div class="col-md-12 col-sm-12 col-xs-12"><div class=text-center>&copy; Copyright <strong>Andrea Dainese</strong>. All Rights Reserved</div><div class=text-center>Designed by <a href=https://bootstrapmade.com/ title=BootstrapMade target=_blank rel=noreferrer>BootstrapMade</a></div></div></div></div></div></footer><script src=/plugins/jquery/jquery.min.js></script>
<script src=/plugins/bootstrap/js/bootstrap.min.js></script>
<script src=/plugins/fancybox/jquery.fancybox.min.js></script>
<script src=/plugins/goodshare/goodshare.min.js></script>
<script src=/plugins/fuse/fuse.min.js></script>
<script src=/plugins/jquery-mark/jquery.mark.min.js></script>
<script src=/js/main.js></script>
<script src=/js/search.js></script></body></html>