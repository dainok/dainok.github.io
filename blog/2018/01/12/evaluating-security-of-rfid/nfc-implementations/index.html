<!doctype html><html lang=en><head><meta name=google-site-verification content="NTPifZ1gNpp6HSoC60ErvHiUUor86ZXg4yHtlpk9lwU"><title>Andrea Dainese > Evaluating security of RFID/NFC implementations</title><meta charset=utf-8><meta name=author content="Andrea Dainese"><meta name=description content="Many companies rely on RFID (Radio-frequency identification) tags for many aspects. Employer badges are often RFID-based and allow for unique identification, authorization, and account for each employer.
Other companies use simple RFID tags or the more evolved NFC smartcards to identify and bill for services."><meta name=generator content="Hugo 0.115.3"><meta name=“robots” content="“noarchive”"><meta name=“robots” content="“notranslate”"><meta name=robots content="noimageindex"><meta property="og:title" content="Evaluating security of RFID/NFC implementations"><meta property="og:description" content="Many companies rely on RFID (Radio-frequency identification) tags for many aspects. Employer badges are often RFID-based and allow for unique identification, authorization, and account for each employer.
Other companies use simple RFID tags or the more evolved NFC smartcards to identify and bill for services."><meta property="og:type" content="article"><meta property="og:url" content="https://www.adainese.it/blog/2018/01/12/evaluating-security-of-rfid/nfc-implementations/"><meta property="og:image" content="https://www.adainese.it/proxmark.png"><meta property="article:section" content="blog"><meta property="article:published_time" content="2018-01-12T00:00:00+00:00"><meta property="article:modified_time" content="2018-01-12T00:00:00+00:00"><meta property="og:site_name" content="Andrea Dainese"><meta name=twitter:card content="summary"><meta name=twitter:site content="@adainese"><meta name=twitter:image content="https://www.adainese.itproxmark.png"><meta name=twitter:title content="Andrea Dainese > Evaluating security of RFID/NFC implementations"><meta name=twitter:description content="Many companies rely on RFID (Radio-frequency identification) tags for many aspects. Employer badges are often RFID-based and allow for unique identification, authorization, and account for each employer.
Other companies use simple RFID tags or the more evolved NFC smartcards to identify and bill for services."><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/rss+xml title="RSS Feed for blog" href=/blog/index.xml><link rel=dns-prefetch href=https://www.googletagmanager.com><link href=https://www.googletagmanager.com rel=preconnect crossorigin><link rel=apple-touch-icon sizes=57x57 href=/favicon/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/favicon/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/favicon/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/favicon/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/favicon/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/favicon/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/favicon/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/favicon/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/favicon/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/favicon/android-icon-192x192.png><link rel=icon type=image/png sizes=16x16 href=/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon/favicon-96x96.png><link rel=stylesheet type=text/css href=/plugins/fontawesome/css/all.min.css><link rel=stylesheet type=text/css href=/plugins/fancybox/jquery.fancybox.min.css><link rel=stylesheet type=text/css href=/fonts/opensans/opensans.css><link rel=stylesheet href=/css/style.min.db8a68dfac8ad6ed301e5f04872a83daee269833ef371fd9ec9475b745de14e5.css integrity="sha256-24po36yK1u0wHl8EhyqD2u4mmDPvNx/Z7JR1t0XeFOU="><link rel=stylesheet href=/css/print.min.a3802e6b39df8780c4980151b47550b34687a140e148c71342fb463b5322e6b1.css media=print integrity="sha256-o4Auaznfh4DEmAFRtHVQs0aHoUDhSMcTQvtGO1Mi5rE="></head><body><button type=button class="mobile-nav-toggle d-lg-none" aria-label="Toggle navigation"><i class="fas fa-bars"></i></button><header id=header class=fixed-top><div class="container d-flex"><div class="logo mr-auto"><h1><a href=/#><span>Andrea</span> Dainese</a></h1></div><nav class="nav-menu d-none d-lg-block"><ul><li><a href=/#>Home</a></li><li><a href=/#about>About</a></li><li class=active><a href=/blog>Blog</a></li><li><a href=/categories>Categories</a></li><li><a href=https://www.patreon.com/adainese target=_blank rel=noreferrer><i class="fa fa-heart"></i></a></li><li><a href=https://www.spreaker.com/podcast/info-sec-unplugged--6025156 target=_blank rel=noreferrer><i class="fa fa-podcast"></i></a></li><li><form class="form-inline ml-2" action=/search><div class="input-group mb-3"><input id=search-query type=text class=form-control placeholder=Search... name=s aria-label="Search within the website" aria-describedby=basic-addon2><div class=input-group-append><button class="btn btn-outline-primary" type=submit aria-label=Search>
<i class="fa fa-search"></i></button></div></div></form></li></ul></nav></div></header><div id=page-header><div class=home-overlay></div><div class=container><div class=row><div class=col-12><div class="page-header-size text-center"><h1>Evaluating security of RFID/NFC implementations</h1></div></div></div></div></div><main id=main><div class=blogpost-single><div class=container><div class=row><div class="col-xs-12 col-sm-12 col-md-4 d-print-none"><div class=blogpost-nav><div class="d-none d-md-block"><div class=blogpost-nav-content><h4>Table of contents</h4><div class=toce><nav id=TableOfContents><ul><li><a href=#the-red-team-perspective>The Red Team perspective</a><ul><li><a href=#upgrading-the-pm3>Upgrading the PM3</a></li><li><a href=#analyzing-rfid-tags-with-proxmark3-easy>Analyzing RFID tags with ProxMark3 Easy</a></li><li><a href=#analyzing-an-em410x-tag>Analyzing an EM410x tag</a></li><li><a href=#analyzing-a-mifare-classic-nfc-smartcard>Analyzing a MiFare Classic NFC smartcard</a></li></ul></li><li><a href=#the-blue-team-perspective>The Blue Team perspective</a></li><li><a href=#conclusions>Conclusions</a></li><li><a href=#references>References</a></li></ul></nav></div></div></div><div class="d-none d-md-block"><div class=blogpost-nav-content><h4>Latest posts</h4><div class=recent-post><div class=recent-post-img><a href=/blog/2025/10/12/frameworks-for-projects-with-cisco-aci-and-ndo/><img class="img-fluid rounded" src=/images/vendors/cisco.webp alt="Post cover"></a></div><div class=recent-post-content><p><a href=/blog/2025/10/12/frameworks-for-projects-with-cisco-aci-and-ndo/>Frameworks for Projects with Cisco ACI and NDO</a><br><i class="fa fa-calendar"></i>
October 12, 2025</p></div></div><div class=recent-post><div class=recent-post-img><a href=/blog/2025/10/05/creating-an-interface-in-strata-cloud-manager/><img class="img-fluid rounded" src=/images/vendors/paloalto.webp alt="Post cover"></a></div><div class=recent-post-content><p><a href=/blog/2025/10/05/creating-an-interface-in-strata-cloud-manager/>Creating an interface in Strata Cloud Manager</a><br><i class="fa fa-calendar"></i>
October 05, 2025</p></div></div><div class=recent-post><div class=recent-post-img><a href=/blog/2025/10/01/circular-dependencies-with-ndo/><img class="img-fluid rounded" src=/images/categories/learning-paths.webp alt="Post cover"></a></div><div class=recent-post-content><p><a href=/blog/2025/10/01/circular-dependencies-with-ndo/>Circular Dependencies with NDO</a><br><i class="fa fa-calendar"></i>
October 01, 2025</p></div></div><div class=recent-post><div class=recent-post-img><a href=/blog/2025/09/28/modifying-an-object-in-strata-cloud-manager/><img class="img-fluid rounded" src=/images/vendors/paloalto.webp alt="Post cover"></a></div><div class=recent-post-content><p><a href=/blog/2025/09/28/modifying-an-object-in-strata-cloud-manager/>Modifying an object in Strata Cloud Manager</a><br><i class="fa fa-calendar"></i>
September 28, 2025</p></div></div><div class=recent-post><div class=recent-post-img><a href=/blog/2025/09/24/from-single-site-to-multi-site-with-ndo/><img class="img-fluid rounded" src=/images/categories/learning-paths.webp alt="Post cover"></a></div><div class=recent-post-content><p><a href=/blog/2025/09/24/from-single-site-to-multi-site-with-ndo/>From Single-Site to Multi-Site with NDO</a><br><i class="fa fa-calendar"></i>
September 24, 2025</p></div></div></div></div><div class="d-none d-md-block"><div class=blogpost-nav-content><h4>Categories</h4><div class=recent-post><div class=recent-post-img><a href=/categories/automation><img class="img-fluid rounded" src=/images/categories/automation.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/automation>Automation</a><br><i class="fa fa-blog"></i> 162 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/learning-paths><img class="img-fluid rounded" src=/images/categories/learning-paths.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/learning-paths>Learning paths</a><br><i class="fa fa-blog"></i> 126 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/ciso><img class="img-fluid rounded" src=/images/categories/ciso.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/ciso>CISO</a><br><i class="fa fa-blog"></i> 23 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/personal-security><img class="img-fluid rounded" src=/images/categories/personal-security.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/personal-security>Personal Security</a><br><i class="fa fa-blog"></i> 22 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/security><img class="img-fluid rounded" src=/images/categories/security.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/security>Security</a><br><i class="fa fa-blog"></i> 20 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/notes><img class="img-fluid rounded" src=/images/categories/notes.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/notes>Notes</a><br><i class="fa fa-blog"></i> 19 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/infrastructure><img class="img-fluid rounded" src=/images/categories/infrastructure.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/infrastructure>Infrastructure</a><br><i class="fa fa-blog"></i> 12 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/ot-ics><img class="img-fluid rounded" src=/images/categories/ot-ics.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/ot-ics>OT/ICS</a><br><i class="fa fa-blog"></i> 5 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/books><img class="img-fluid rounded" src=/images/categories/books.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/books>Books</a><br><i class="fa fa-blog"></i> 3 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/unetlab><img class="img-fluid rounded" src=/images/categories/unetlab.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/unetlab>UNetLab</a><br><i class="fa fa-blog"></i> 3 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/writeup><img class="img-fluid rounded" src=/images/categories/writeup.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/writeup>Write-up</a><br><i class="fa fa-blog"></i> 3 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/osint><img class="img-fluid rounded" src=/images/categories/osint.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/osint>OSInt</a><br><i class="fa fa-blog"></i> 2 posts</p></div></div><div class=recent-post><div class=recent-post-img><a href=/categories/life><img class="img-fluid rounded" src=/images/categories/life.webp alt="Category cover"></a></div><div class=recent-post-content><p><a href=/categories/life>My life</a><br><i class="fa fa-blog"></i> 1 posts</p></div></div></div></div></div></div><div class="col-xs-12 col-sm-12 col-md-8 blogpost-container"><div class=row><div class="col-md-12 col-sm-12 col-xs-12"><article><div class=blogpost-single-content><h2>Evaluating security of RFID/NFC implementations</h2><div class=blogpost-single-meta><div><i class="fa fa-user"></i> Andrea Dainese</div><div><i class="fa fa-calendar"></i>
January 12, 2018</div><div class=tag-meta><i class="fa fa-folder"></i>
<a href=/categories/security/ title="All posts under Security">Security</a></div></div><div class=entry-content><div><a data-fancybox=gallery href=/blog/2018/01/12/evaluating-security-of-rfid/nfc-implementations/proxmark.webp><img class="img-fluid w-25 rounded shadow float-right" src=/blog/2018/01/12/evaluating-security-of-rfid/nfc-implementations/proxmark.webp alt="Post cover"></a></div><p>Many companies rely on RFID (Radio-frequency identification) tags for many aspects. Employer badges are often RFID-based and allow for unique identification, authorization, and account for each employer.</p><p>Other companies use simple RFID tags or the more evolved NFC smartcards to identify and bill for services. Many home alarm systems use RFID tags to manage arm/disarm operations. Moreover, RFID tags are used to identify goods within stores or buildings in general.
In a utopian world, everything would be fine, but in the real world, we should ask how we can trust users, and technology and we must evaluate the risks caused by a tampered NFC smartcard or RFID in general.</p><p>What about if an employer badge is duplicated?
What about if a home alarm NFC smartcard is duplicated?
What about if a laundry machine smartcard has been tampered?
What about if an RFID tag is substituted/deactivated?</p><p>This won&rsquo;t be an exhaustive post about RFID technology, we&rsquo;ll focus on how they are used in the real world.
The most common RFID devices we found, are:</p><ul><li>125kHz RFID tags (EM410x)</li><li>13.56MHZ NFC smartcards (MIFARE Classic)</li></ul><p>Both of them are old and very insecure for many reasons.</p><h2 id=the-red-team-perspective>The Red Team perspective</h2><p>The cheapest and most flexible tool we found is ProxMark3 (PM3) Easy, it can be found on eBay at about 60€. It&rsquo;s a USB device with two antennas, for 125kHz and 15.56MHz tags. The bundle includes some blank tags.</p><p>We&rsquo;re using the PM3 attached to a VM running the latest Kali Linux on VMware Fusion. The PM3 can be mapped to the VM and it works fine.</p><h3 id=upgrading-the-pm3>Upgrading the PM3</h3><p>Before using the PM3, it must be upgraded. Connect it to a Linux OS, and check if it&rsquo;s detected using <code>dmesg</code> and/or <code>lsusb</code>. If it&rsquo;s not detected, unplug it, press and hold the button on the PM3, and plug it again (keep the PM3 button pressed).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># dmesg</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> 3056.340405<span style=color:#f92672>]</span> usb 1-2.2: new full-speed USB device number <span style=color:#ae81ff>5</span> using uhci_hcd
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> 3056.455030<span style=color:#f92672>]</span> usb 1-2.2: New USB device found, idVendor<span style=color:#f92672>=</span>9ac4, idProduct<span style=color:#f92672>=</span>4b8f
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> 3056.455033<span style=color:#f92672>]</span> usb 1-2.2: New USB device strings: Mfr<span style=color:#f92672>=</span>1, Product<span style=color:#f92672>=</span>2, SerialNumber<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> 3056.455034<span style=color:#f92672>]</span> usb 1-2.2: Product: PM3
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> 3056.455035<span style=color:#f92672>]</span> usb 1-2.2: Manufacturer: proxmark.org
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> 3056.623029<span style=color:#f92672>]</span> cdc_acm 1-2.2:1.0: ttyACM0: USB ACM device
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> 3056.625835<span style=color:#f92672>]</span> usbcore: registered new interface driver cdc_acm
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> 3056.625836<span style=color:#f92672>]</span> cdc_acm: USB Abstract Control Model driver <span style=color:#66d9ef>for</span> USB modems and ISDN adapters
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> 3171.708851<span style=color:#f92672>]</span> usb 1-2.2: USB disconnect, device number <span style=color:#ae81ff>5</span>
</span></span></code></pre></div><p>Please read the full
<a href=https://github.com/Proxmark/proxmark3/wiki/Kali-Linux#Upgrading_Proxmark3_to_CDC_Bootloader title="Proxmark3 on Kali Linux" target=_blank rel=noopener>HowTo</a>
before continuing.
Now download and prepare the environment to upgrade the PM3:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get -y install git build-essential libreadline5 libreadline-dev gcc-arm-none-eabi libusb-0.1-4 libusb-dev libqt4-dev ncurses-dev perl pkg-config
</span></span><span style=display:flex><span>cd /usr/src/
</span></span><span style=display:flex><span>sudo git clone https://github.com/Proxmark/proxmark3
</span></span><span style=display:flex><span>cd proxmark3
</span></span><span style=display:flex><span>cd armsrc make
</span></span><span style=display:flex><span>cd ..
</span></span><span style=display:flex><span>cd client
</span></span><span style=display:flex><span>sudo make
</span></span></code></pre></div><p>And now (from the <code>client</code> directory) upgrade the boot loader (if required) and the firmware:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo ./flasher /dev/ttyACM0 -b ../bootrom/obj/bootrom.elf
</span></span><span style=display:flex><span>sudo ./flasher /dev/ttyACM0 ../armsrc/obj/fullimage.elf
</span></span></code></pre></div><p>Remember you need to keep the PM3 button pressed, as explained before.</p><p>Inside the <code>client</code> directory run the PM3 client:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span># ./proxmark3 /dev/ttyACM0
</span></span><span style=display:flex><span>proxmark3&gt; hw status
</span></span><span style=display:flex><span>#db# Memory
</span></span><span style=display:flex><span>#db#   BIGBUF_SIZE.............40000
</span></span><span style=display:flex><span>#db#   Available memory........40000
</span></span><span style=display:flex><span>#db# Tracing
</span></span><span style=display:flex><span>#db#   tracing ................1
</span></span><span style=display:flex><span>#db#   traceLen ...............0
</span></span><span style=display:flex><span>#db# Fgpa
</span></span><span style=display:flex><span>#db#   mode....................HF
</span></span><span style=display:flex><span>#db# LF Sampling config:
</span></span><span style=display:flex><span>#db#   [q] divisor:           95
</span></span><span style=display:flex><span>#db#   [b] bps:               8
</span></span><span style=display:flex><span>#db#   [d] decimation:        1
</span></span><span style=display:flex><span>#db#   [a] averaging:         1
</span></span><span style=display:flex><span>#db#   [t] trigger threshold: 0
</span></span><span style=display:flex><span>#db# USB Speed:
</span></span><span style=display:flex><span>#db#   Sending USB packets to client...
</span></span><span style=display:flex><span>#db#   Time elapsed:      1500ms
</span></span><span style=display:flex><span>#db#   Bytes transferred: 875008
</span></span><span style=display:flex><span>#db#   USB Transfer Speed PM3 -&gt; Client = 583338 Bytes/s
</span></span><span style=display:flex><span>#db# Various
</span></span><span style=display:flex><span>#db#   MF_DBGLEVEL......2
</span></span><span style=display:flex><span>#db#   ToSendMax........-722433155
</span></span><span style=display:flex><span>#db#   ToSendBit........0
</span></span><span style=display:flex><span>proxmark3&gt; hw version
</span></span><span style=display:flex><span>[[[ Cached information ]]]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Prox/RFID mark3 RFID instrument
</span></span><span style=display:flex><span>bootrom: master/v3.0.1-181-gaa264ab-suspect 2017-11-14 18:49:33
</span></span><span style=display:flex><span>os: master/v3.0.1-233-g91e0384-suspect 2017-12-27 20:48:13
</span></span><span style=display:flex><span>LF FPGA image built for 2s30vq100 on 2015/03/06 at 07:38:04
</span></span><span style=display:flex><span>HF FPGA image built for 2s30vq100 on 2017/10/27 at 08:30:59
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>uC: AT91SAM7S256 Rev D
</span></span><span style=display:flex><span>Embedded Processor: ARM7TDMI
</span></span><span style=display:flex><span>Nonvolatile Program Memory Size: 256K bytes. Used: 197722 bytes (75%). Free: 64422 bytes (25%).
</span></span><span style=display:flex><span>Second Nonvolatile Program Memory Size: None
</span></span><span style=display:flex><span>Internal SRAM Size: 64K bytes
</span></span><span style=display:flex><span>Architecture Identifier: AT91SAM7Sxx Series
</span></span><span style=display:flex><span>Nonvolatile Program Memory Type: Embedded Flash Memory
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>proxmark3&gt; hw tune
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Measuring antenna characteristics, please wait...
</span></span><span style=display:flex><span># LF antenna: 25.57 V @   125.00 kHz
</span></span><span style=display:flex><span># LF antenna: 19.80 V @   134.00 kHz
</span></span><span style=display:flex><span># LF optimal: 25.57 V @   123.71 kHz
</span></span><span style=display:flex><span># HF antenna: 24.03 V @    13.56 MHz
</span></span><span style=display:flex><span>Displaying LF tuning graph. Divisor 89 is 134khz, 95 is 125khz.
</span></span></code></pre></div><h3 id=analyzing-rfid-tags-with-proxmark3-easy>Analyzing RFID tags with ProxMark3 Easy</h3><p>PM3 is now ready to read tags. To scan an unknown tag we need to type two commands, one for each antenna:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>proxmark3&gt; hf search
</span></span><span style=display:flex><span>proxmark3&gt; lf search
</span></span></code></pre></div><p>If the scanned tag is supported, one of the above commands should answer with the details of the tag.</p><h3 id=analyzing-an-em410x-tag>Analyzing an EM410x tag</h3><p>The following is an access card for a restricted area:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>proxmark3&gt; lf search
</span></span><span style=display:flex><span>NOTE: some demods output possible binary
</span></span><span style=display:flex><span>  if it finds something that looks like a tag
</span></span><span style=display:flex><span>False Positives ARE possible
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Checking for known tags:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>EM410x pattern found:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>EM TAG ID      : 1111111111
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Possible de-scramble patterns
</span></span><span style=display:flex><span>Unique TAG ID  : 2222222222
</span></span><span style=display:flex><span>HoneyWell IdentKey {
</span></span><span style=display:flex><span>DEZ 8          : 01118481
</span></span><span style=display:flex><span>DEZ 10         : 0286331153
</span></span><span style=display:flex><span>DEZ 5.5        : 04369.04369
</span></span><span style=display:flex><span>DEZ 3.5A       : 017.04369
</span></span><span style=display:flex><span>DEZ 3.5B       : 017.04369
</span></span><span style=display:flex><span>DEZ 3.5C       : 017.04369
</span></span><span style=display:flex><span>DEZ 14/IK2     : 00073300775185
</span></span><span style=display:flex><span>DEZ 15/IK3     : 000586406201480
</span></span><span style=display:flex><span>DEZ 20/ZK      : 08080808080808080808
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>Other          : 04369_017_01118481
</span></span><span style=display:flex><span>Pattern Paxton : 287657745 [0x11254F11]
</span></span><span style=display:flex><span>Pattern 1      : 4342282 [0x42420A]
</span></span><span style=display:flex><span>Pattern Sebury : 4369 17 1118481  [0x1111 0x11 0x111111]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Valid EM410x ID Found!
</span></span></code></pre></div><p>We guess that the authentications is based on EM TAG ID only, so we need to copy that on a new tag:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>proxmark3&gt; lf em 410xwrite 1111111111 1
</span></span><span style=display:flex><span>Writing T55x7 tag with UID 0x1111111111 (clock rate: 64)
</span></span><span style=display:flex><span>#db# Started writing T55x7 tag ...
</span></span><span style=display:flex><span>#db# Clock rate: 64
</span></span><span style=display:flex><span>#db# Tag T55x7 written with 0xffc700025fddc8be
</span></span></code></pre></div><p>And it worked.</p><p>We discovered that many companies still rely on weak technology for access control.</p><h3 id=analyzing-a-mifare-classic-nfc-smartcard>Analyzing a MiFare Classic NFC smartcard</h3><p>The following is an access card for a restricted area:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>proxmark3&gt; hf search
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> UID : 11 11 11 11
</span></span><span style=display:flex><span>ATQA : 00 04
</span></span><span style=display:flex><span> SAK : 08 [2]
</span></span><span style=display:flex><span>TYPE : NXP MIFARE CLASSIC 1k | Plus 2k SL1
</span></span><span style=display:flex><span>proprietary non iso14443-4 card found, RATS not supported
</span></span><span style=display:flex><span>No chinese magic backdoor command detected
</span></span><span style=display:flex><span>Prng detection: WEAK
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Valid ISO14443A Tag Found - Quiting Search
</span></span></code></pre></div><p>MiFare Classic smartcards are not secure:</p><blockquote><p>We can recover the full 48-bit key of the MiFare algorithm in 200 seconds on a PC, given 1 known IV (from one single encryption).
The security of this cipher is therefore close to zero.</p><p>Courtois, Nicolas T.; Karsten Nohl; Sean O&rsquo;Neil (2008-04-14). &ldquo;Algebraic Attacks on the Crypto-1 Stream Cipher in MiFare Classic and Oyster Cards&rdquo;. Cryptology ePrint Archive.</p></blockquote><p>By the way, in many cases, we don&rsquo;t even need to crack a card because:</p><ul><li>UID is enough</li><li>data are not encrypted or encrypted with a default key</li></ul><p>Let&rsquo;s start with the easier and common scenario, and let&rsquo;s clone the UID only to another smartcard:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>proxmark3&gt; hf mf csetuid 11111111
</span></span><span style=display:flex><span>uid:8e 71 ae 0f
</span></span><span style=display:flex><span>#db# halt error. response len: 1
</span></span><span style=display:flex><span>Chinese magic backdoor commands (GEN 1a) detected
</span></span><span style=display:flex><span>#db# halt error. response len: 1
</span></span><span style=display:flex><span>#db# Halt error
</span></span><span style=display:flex><span>old block 0:  c0 92 ee 01 bd 08 04 00 62 63 64 65 66 67 68 69
</span></span><span style=display:flex><span>new block 0:  11 11 11 11 5e 08 04 00 62 63 64 65 66 67 68 69
</span></span><span style=display:flex><span>#db# halt error. response len: 1
</span></span><span style=display:flex><span>old UID:c0 92 ee 01
</span></span><span style=display:flex><span>new UID:11 11 11 11
</span></span></code></pre></div><p>And it works with many access cards based on MiFare Classic.</p><p>Other implementations, like public laundry machines or public transport, save additional data, that can be possibly encrypted:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>proxmark3&gt; hf mf chk - ?
</span></span><span style=display:flex><span>No key specified, trying default keys
</span></span><span style=display:flex><span>chk default key[ 0] ffffffffffff
</span></span><span style=display:flex><span>chk default key[ 1] 000000000000
</span></span><span style=display:flex><span>chk default key[ 2] a0a1a2a3a4a5
</span></span><span style=display:flex><span>chk default key[ 3] b0b1b2b3b4b5
</span></span><span style=display:flex><span>chk default key[ 4] aabbccddeeff
</span></span><span style=display:flex><span>chk default key[ 5] 1a2b3c4d5e6f
</span></span><span style=display:flex><span>chk default key[ 6] 123456789abc
</span></span><span style=display:flex><span>chk default key[ 7] 010203040506
</span></span><span style=display:flex><span>chk default key[ 8] 123456abcdef
</span></span><span style=display:flex><span>chk default key[ 9] abcdef123456
</span></span><span style=display:flex><span>chk default key[10] 4d3a99c351dd
</span></span><span style=display:flex><span>chk default key[11] 1a982c7e459a
</span></span><span style=display:flex><span>chk default key[12] d3f7d3f7d3f7
</span></span><span style=display:flex><span>chk default key[13] 714c5c886e97
</span></span><span style=display:flex><span>chk default key[14] 587ee5f9350f
</span></span><span style=display:flex><span>chk default key[15] a0478cc39091
</span></span><span style=display:flex><span>chk default key[16] 533cb6c723f6
</span></span><span style=display:flex><span>chk default key[17] 8fd0a4f256e9
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>To cancel this operation press the button on the proxmark...
</span></span><span style=display:flex><span>--o
</span></span><span style=display:flex><span>|---|----------------|---|----------------|---|
</span></span><span style=display:flex><span>|sec|key A           |res|key B           |res|
</span></span><span style=display:flex><span>|---|----------------|---|----------------|---|
</span></span><span style=display:flex><span>|000|  ffffffffffff  | 1 |  ffffffffffff  | 1 |
</span></span><span style=display:flex><span>|001|  ffffffffffff  | 1 |  ffffffffffff  | 1 |
</span></span><span style=display:flex><span>|002|  ffffffffffff  | 1 |  ffffffffffff  | 1 |
</span></span><span style=display:flex><span>|003|  ffffffffffff  | 1 |  ffffffffffff  | 1 |
</span></span><span style=display:flex><span>|004|  ffffffffffff  | 1 |  ffffffffffff  | 1 |
</span></span><span style=display:flex><span>|005|  ffffffffffff  | 1 |  ffffffffffff  | 1 |
</span></span><span style=display:flex><span>|006|  ffffffffffff  | 1 |  ffffffffffff  | 1 |
</span></span><span style=display:flex><span>|007|  ffffffffffff  | 1 |  ffffffffffff  | 1 |
</span></span><span style=display:flex><span>|008|  ffffffffffff  | 1 |  ffffffffffff  | 1 |
</span></span><span style=display:flex><span>|009|  ffffffffffff  | 1 |  ffffffffffff  | 1 |
</span></span><span style=display:flex><span>|010|  ffffffffffff  | 1 |  ffffffffffff  | 1 |
</span></span><span style=display:flex><span>|011|  ffffffffffff  | 1 |  ffffffffffff  | 1 |
</span></span><span style=display:flex><span>|012|  ffffffffffff  | 1 |  ffffffffffff  | 1 |
</span></span><span style=display:flex><span>|013|  ffffffffffff  | 1 |  ffffffffffff  | 1 |
</span></span><span style=display:flex><span>|014|  ffffffffffff  | 1 |  ffffffffffff  | 1 |
</span></span><span style=display:flex><span>|015|  ffffffffffff  | 1 |  ffffffffffff  | 1 |
</span></span><span style=display:flex><span>|---|----------------|---|----------------|---|
</span></span></code></pre></div><p>The above card is using the default key: <code>ffffffffffff</code>.
If data are partially encrypted with a non-default key, we can try a nested attack, using one of the default keys:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>proxmark3&gt; hf mf nested 1 0 A ffffffffffff d
</span></span></code></pre></div><p>Or we can test other attacks:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>proxmark3&gt; hf mf mifare
</span></span></code></pre></div><p>Once we have all keys (dumped into <code>dumpkeys.bin</code> file), we can dump the card into the <code>dumpdata.bin</code> file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>proxmark3&gt; hf mf dump 1
</span></span></code></pre></div><p>And we can copy the content to a new card:</p><pre tabindex=0><code class=language-texts data-lang=texts>proxmark3&gt; hf mf restore 1
</code></pre><p>And it worked.</p><p>We discovered that even if additional (but weak) security layers are available, they are rarely used.</p><h2 id=the-blue-team-perspective>The Blue Team perspective</h2><p>Each component included, installed, and used in any enterprise (or any house) should be evaluated especially if it can lead to a security breach. Referring to a company, if the evaluation cannot be provided by an internal team, use one (or more) trusted external service. Don&rsquo;t trust vendors without testing them. Don&rsquo;t buy or implement solutions without knowing them in the detail.</p><p>Secure smartcard solutions currently exist, but the question is: for how long they will remain secure?
The question is very important, because if a big worldwide enterprise decides to implement an access solution based on the latest and most secure smartcard for 30000 employers, what it should do if (better say when) that smartcard will no more secure? How much does cost the migration to another access control system?
Should it use something upgradeable (like an app on a smartphone), or should it maintain a weak access control?</p><p>It depends, as always&mldr; on risk and cost analysis.</p><h2 id=conclusions>Conclusions</h2><p>We discovered a large number of weak implementations, provided also by respectable vendors but implemented poorly. Day after day we realized that no vendor can be blinded trusted, no matter how respectable it is.
If enterprises can usually afford the cost of a third opinion, end users rarely can. The more IoT, smart homes we see, the more I tend to get a simple &ldquo;smart less&rdquo; building. This is still not the era of the &ldquo;apartment thieves&rdquo;, but it will come soon.</p><h2 id=references>References</h2><ul><li><a href=https://github.com/Proxmark/proxmark3/wiki title="ProxMark3 Wiki" target=_blank rel=noopener>Proxmark3 Wiki</a></li><li><a href=https://github.com/Proxmark/proxmark3/wiki/Kali-Linux title="Proxmark3 on Kali Linux" target=_blank rel=noopener>Proxmark3 on Kali Linux</a></li><li><a href=https://www.offensive-security.com/offsec/cloning-rfid-tags-with-proxmark-3/ title="Cloning RFID Tags with Proxmark 3" target=_blank rel=noopener>Cloning RFID Tags with Proxmark 3</a></li><li><a href=https://blog.kchung.co/rfid-hacking-with-the-proxmark-3/ title="RFID Hacking with The Proxmark 3" target=_blank rel=noopener>RFID Hacking with The Proxmark 3</a></li><li><a href=https://blog.kchung.co/reverse-engineering-hid-iclass-master-keys/ title="Reverse Engineering HID iClass Master Keys" target=_blank rel=noopener>Reverse Engineering HID iClass Master Keys</a></li><li><a href=https://eprint.iacr.org/2008/166.pdf title="Algebraic Attacks on the Crypto-1 Stream Cipher in MiFare Classic and Oyster Cards" target=_blank rel=noopener>Algebraic Attacks on the Crypto-1 Stream Cipher in MiFare Classic and Oyster Cards</a></li><li><a href=http://nearfieldcommunication.org/nfc-security-risks.html title="Security Risks of Near Field Communication" target=_blank rel=noopener>Security Risks of Near Field Communication</a></li></ul></div></div></article><div class=clear></div></div></div></div></div></div></div></main><footer class=d-print-none><div class=footer-profile><div class=container id=contact><div class=row><div class="col-xs-12 col-sm-12 col-md-4"><div class=footer-head><h2><span>Andrea</span> Dainese</h2></div><p>For information, collaborations, proposals, requests for help, donations, use one of the following channels; email is preferred.</p><div class=footer-icons><ul><li><a href=https://www.patreon.com/adainese title="Support me" target=_blank rel=noreferrer><i class="fa fa-heart"></i></a></li><li><a href=https://www.linkedin.com/in/adainese/ title="LinkedIn profile" target=_blank rel=noreferrer><i class="fab fa-linkedin-in"></i></a></li><li><a href=https://twitter.com/adainese title="Twitter profile" target=_blank rel=noreferrer><i class="fab fa-twitter"></i></a></li><li><a href=mailto:andrea@adainese.it title="Secure email" target=_blank rel=noreferrer><i class="fa fa-envelope"></i></a></li><li><a href=https://www.spreaker.com/podcast/info-sec-unplugged--6025156 title=Podcast target=_blank rel=noreferrer><i class="fa fa-podcast"></i></a></li><li><a href=https://github.com/dainok/ title="GitHub repositories" target=_blank rel=noreferrer><i class="fab fa-github"></i></a></li><li><a href=/blog/index.xml title="RSS Feed" target=_blank><i class="fa fa-rss"></i></a></li></ul></div></div><div class="col-xs-12 col-sm-12 col-md-4"><div class=footer-head><h4>Past events</h4></div><div class=footer-content><ul><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20240305-cisco-aci-automation.pdf title="View slides" target=_blank rel=noreferrer>SDN: Software Defined Now</a></li><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20231122-cybercrime.pdf title="View slides" target=_blank rel=noreferrer>Cybercrime</a></li><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20220901-bgp-attack-scenarios.pdf title="View slides" target=_blank rel=noreferrer>BGP attack scenarios</a></li><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20220317-approaching-ot-ics-security.pdf title="View slides" target=_blank rel=noreferrer>Approaching OT/ICS Security</a> (with <a href=https://www.festocte.it/eventi/industry_4_0/17-03-2022/webinar_la_cybersecurity_nelle_reti_di_fabbrica_P/>Festo Academy</a>)</li><li><a href="https://www.youtube.com/watch?v=sjQZghTkHkA" title="View recording" target=_blank rel=noreferrer><i class="fa fa-video"></i></a>&nbsp;-&nbsp;<a href=/files/slides/20200922-cyberrange.pdf title="View slides" target=_blank rel=noreferrer>Cyber Range: Analyzing a Cyber Attack</a></li><li><a href="https://www.youtube.com/watch?v=-PWtGaS28dk" title="View recording" target=_blank rel=noreferrer><i class="fa fa-video"></i></a>&nbsp;-&nbsp;<a href=/files/slides/20200623-clubitfvg-securing-ot-ics-plants.pdf title="View slides" target=_blank rel=noreferrer>Securing OT/ICS plants</a></li><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20190226-automation-for-cisco-netops.pdf title="View slides" target=_blank rel=noreferrer>Automation for Cisco NetOps</a></li><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20181107-ciscon-sdn-complexity-and-tco-looking-for-an-easy-way.pdf title="View slides" target=_blank rel=noreferrer>SDN, Complexity and TCO</a></li><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20181003-nts-protection-and-visibility-for-enterprise-networks.pdf title="View slides" target=_blank rel=noreferrer>Protection and visibility for enterprise networks</a></li><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20141106-festival-ict-why-wan-accelerators-still-matter.pdf title="View slides" target=_blank rel=noreferrer>Why WAN AccelerAtors (still) matter?</a></li><li><i class="fa fa-video-slash"></i>&nbsp;-&nbsp;<a href=/files/slides/20130918-festival-ict-designing-an-hybrid-data-center-infrastructure.pdf title="View slides" target=_blank rel=noreferrer>Designing an Hybrid Data Center Infrastructure</a></li></ul></div></div><div class="d-none d-md-block col-md-4"><div class=footer-head><h4>Competencies</h4></div><div class=footer-slides><div class=footer-slide-container><div class=footer-slide><img src=/images/categories/security-125x100.webp alt="Incident Response"><div class=overlay>Incident Response</div></div></div><div class=footer-slide-container><div class=footer-slide><img src=/images/categories/ciso-125x100.webp alt=Advisor><div class=overlay>Advisor</div></div></div><div class=footer-slide-container><div class=footer-slide><img src=/images/categories/osint-125x100.webp alt="Open Source Intelligence (OSINT)"><div class=overlay>Open Source Intelligence (OSINT)</div></div></div><div class=footer-slide-container><div class=footer-slide><img src=/images/categories/infrastructure-125x100.webp alt="System Integration / Automation"><div class=overlay>System Integration / Automation</div></div></div><div class=footer-slide-container><div class=footer-slide><img src=/images/categories/writeup-125x100.webp alt="Training / Education / Cyber Range"><div class=overlay>Training / Education / Cyber Range</div></div></div><div class=footer-slide-container><div class=footer-slide><img src=/images/categories/personal-security-125x100.webp alt="Personal Security"><div class=overlay>Personal Security</div></div></div></div></div></div></div></div><div class=footer-copyright><div class=container><div class=row><div class="col-md-12 col-sm-12 col-xs-12"><div class=text-center>&copy; Copyright <strong>Andrea Dainese</strong>. All Rights Reserved</div><div class=text-center>Designed by <a href=https://bootstrapmade.com/ title=BootstrapMade target=_blank rel=noreferrer>BootstrapMade</a></div></div></div></div></div></footer><script src=/plugins/jquery/jquery.min.js></script>
<script src=/plugins/bootstrap/js/bootstrap.min.js></script>
<script src=/plugins/fancybox/jquery.fancybox.min.js></script>
<script src=/plugins/goodshare/goodshare.min.js></script>
<script src=/plugins/fuse/fuse.min.js></script>
<script src=/plugins/jquery-mark/jquery.mark.min.js></script>
<script src=/js/main.js></script>
<script src=/js/search.js></script></body></html>